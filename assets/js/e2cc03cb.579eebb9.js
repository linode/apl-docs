"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[1241],{1534:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var i=n(5893),l=n(1151);const r={slug:"ingress-classes",title:"Manage Ingress Controllers"},a=void 0,o={id:"for-ops/how-to/ingress-classes",title:"Manage Ingress Controllers",description:"Exposure (ingress) for all services (included exposure for platform services) is handeled by the default platform ingress class using a public (cloud) load balancer. It is also possible to use multiple ingress classes. Each class will get a dedicated ingress controller. In case of a security requirement, where platform services are not allowed to be exposed publicly, the default platform class can be configured to use a private load balancer instead of a public one by adding the required annotations. Additional (public) ingress classes can be created to expose team (application) services.",source:"@site/docs/for-ops/how-to/ingress-classes.md",sourceDirName:"for-ops/how-to",slug:"/for-ops/how-to/ingress-classes",permalink:"/docs/for-ops/how-to/ingress-classes",draft:!1,unlisted:!1,editUrl:"https://github.com/linode/linode.github.io/tree/main/docs/for-ops/how-to/ingress-classes.md",tags:[],version:"current",frontMatter:{slug:"ingress-classes",title:"Manage Ingress Controllers"},sidebar:"mainSidebar",previous:{title:"Manage the Catalog",permalink:"/docs/for-ops/how-to/catalog"},next:{title:"Use Team Admin",permalink:"/docs/for-ops/how-to/use-team-admin"}},t={},c=[{value:"prerequisites",id:"prerequisites",level:2},{value:"Steps",id:"steps",level:2},{value:"Create an additional public ingress class",id:"create-an-additional-public-ingress-class",level:3},{value:"Move all existing Team Services to use the new ingress class",id:"move-all-existing-team-services-to-use-the-new-ingress-class",level:3},{value:"Change the platform class from public to private",id:"change-the-platform-class-from-public-to-private",level:3},{value:"Cloud provider specific annotations",id:"cloud-provider-specific-annotations",level:3},{value:"AWS",id:"aws",level:4},{value:"Azure",id:"azure",level:4},{value:"Digital Ocean",id:"digital-ocean",level:4}];function d(e){const s={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",ul:"ul",...(0,l.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:"Exposure (ingress) for all services (included exposure for platform services) is handeled by the default platform ingress class using a public (cloud) load balancer. It is also possible to use multiple ingress classes. Each class will get a dedicated ingress controller. In case of a security requirement, where platform services are not allowed to be exposed publicly, the default platform class can be configured to use a private load balancer instead of a public one by adding the required annotations. Additional (public) ingress classes can be created to expose team (application) services."}),"\n",(0,i.jsx)(s.h2,{id:"prerequisites",children:"prerequisites"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Access to the internal subnet (using a VPN or a Jumphost) when using a private load balancer."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"steps",children:"Steps"}),"\n",(0,i.jsx)(s.p,{children:"Steps to change to use a private load balancer for exposing platform services:"}),"\n",(0,i.jsx)(s.p,{children:"If there are no Team services created that use the default platform class, then you can skip step 2."}),"\n",(0,i.jsx)(s.h3,{id:"create-an-additional-public-ingress-class",children:"Create an additional public ingress class"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Go to Ingress Classes under Settings in the web UI."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Under ",(0,i.jsx)(s.code,{children:"additional classes"})," click on ",(0,i.jsx)(s.code,{children:"add item"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Provide a name for the additional ingress class (for example ",(0,i.jsx)(s.code,{children:"teams"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["(optional) If you need to add specific annotations to Configure the Load Balancer by applying annotations to the Service resource, Click on ",(0,i.jsx)(s.code,{children:"Add Item"})," and add the required annotations."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"(optional) If you would like to use a static (public) IP for the load balancer, then fill in the IP address."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["(optional) If you need to whitelist source IP address ranges, add the CIDR in the ",(0,i.jsx)(s.code,{children:"Source IP address filtering"})," field."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Click ",(0,i.jsx)(s.code,{children:"submit"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Click ",(0,i.jsx)(s.code,{children:"Deploy Changes"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"move-all-existing-team-services-to-use-the-new-ingress-class",children:"Move all existing Team Services to use the new ingress class"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Go to ",(0,i.jsx)(s.code,{children:"services"}),", click on the service you would like to move to the new ingress class."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Under ",(0,i.jsx)(s.code,{children:"Exposure Ingress"}),", fill in the name of the new ingress class in the ",(0,i.jsx)(s.code,{children:"ingress class name"})," field."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Click ",(0,i.jsx)(s.code,{children:"submit"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Click ",(0,i.jsx)(s.code,{children:"Deploy Changes"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"change-the-platform-class-from-public-to-private",children:"Change the platform class from public to private"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Go to Ingress Classes under Settings in the web UI."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Under ",(0,i.jsx)(s.code,{children:"Platform class"}),", add the required ",(0,i.jsx)(s.code,{children:"annotations"}),":"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"For Azure:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'service.beta.kubernetes.io/azure-load-balancer-internal: "true"'})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"service.beta.kubernetes.io/azure-load-balancer-internal-subnet: <lb-subnet>"})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"For AWS:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"service.beta.kubernetes.io/aws-load-balancer-internal: true"})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"For GCP:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:'networking.gke.io/load-balancer-type: "Internal"'})}),"\n"]}),"\n",(0,i.jsxs)(s.ol,{start:"4",children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Click ",(0,i.jsx)(s.code,{children:"submit"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Click ",(0,i.jsx)(s.code,{children:"Deploy Changes"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"cloud-provider-specific-annotations",children:"Cloud provider specific annotations"}),"\n",(0,i.jsx)(s.p,{children:"Add the following annotations when using:"}),"\n",(0,i.jsx)(s.h4,{id:"aws",children:"AWS"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"service.beta.kubernetes.io/aws-load-balancer-proxy-protocol: '*'"})}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"azure",children:"Azure"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"service.beta.kubernetes.io/azure-load-balancer-resource-group: <resource-group-name>"})}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"digital-ocean",children:"Digital Ocean"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.code,{children:"service.beta.kubernetes.io/do-loadbalancer-enable-proxy-protocol: true"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.a)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>o,a:()=>a});var i=n(7294);const l={},r=i.createContext(l);function a(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);