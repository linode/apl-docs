"use strict";(self.webpackChunkredkubes_github_io=self.webpackChunkredkubes_github_io||[]).push([[3039],{1817:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>i,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var n=a(5893),t=a(1151);const r={slug:"custom-dashboards",title:"Create custom dashboards",sidebar_label:"Create Custom Dashboards"},d=void 0,o={id:"get-started/labs/custom-dashboards",title:"Create custom dashboards",description:"In the lab Using custom metrics we created a Workload with a ServiceMonitor so the Team's Prometheus can scrape our custom metrics. In this lab we are going to create a custom Grafana dashboard and add the dashboard to a Configmap so the Team's Grafana will automatically load the dashboard.",source:"@site/docs/get-started/labs/custom-dashboards.md",sourceDirName:"get-started/labs",slug:"/get-started/labs/custom-dashboards",permalink:"/docs/get-started/labs/custom-dashboards",draft:!1,unlisted:!1,editUrl:"https://github.com/linode/linode.github.io/tree/main/docs/get-started/labs/custom-dashboards.md",tags:[],version:"current",frontMatter:{slug:"custom-dashboards",title:"Create custom dashboards",sidebar_label:"Create Custom Dashboards"},sidebar:"mainSidebar",previous:{title:"Using custom metrics",permalink:"/docs/get-started/labs/custom-metrics"},next:{title:"Create Custom Rules",permalink:"/docs/get-started/labs/custom-rules"}},i={},l=[{value:"Create a dashboard in Grafana",id:"create-a-dashboard-in-grafana",level:2},{value:"Make the dashboard persistent",id:"make-the-dashboard-persistent",level:2}];function c(e){const s={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.p,{children:["In the lab ",(0,n.jsx)(s.a,{href:"/docs/get-started/labs/custom-metrics",children:"Using custom metrics"})," we created a Workload with a ServiceMonitor so the Team's Prometheus can scrape our custom metrics. In this lab we are going to create a custom Grafana dashboard and add the dashboard to a Configmap so the Team's Grafana will automatically load the dashboard."]}),"\n",(0,n.jsx)(s.h2,{id:"create-a-dashboard-in-grafana",children:"Create a dashboard in Grafana"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the left menu, click on ",(0,n.jsx)(s.code,{children:"Apps"})," and open ",(0,n.jsx)(s.code,{children:"Grafana"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Go to the Grafana dashboard homepage."}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the top right click on ",(0,n.jsx)(s.code,{children:"New"})," and then ",(0,n.jsx)(s.code,{children:"New Dashboard"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Click ",(0,n.jsx)(s.code,{children:"+ Add visualization"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the ",(0,n.jsx)(s.code,{children:"Query"})," tab select ",(0,n.jsx)(s.code,{children:"Prometheus (default)"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the ",(0,n.jsx)(s.code,{children:"A"})," collapsible section, select a metric from the ",(0,n.jsx)(s.code,{children:"Metric"})," drop-down list. In our example we use the ",(0,n.jsx)(s.code,{children:"application_greetings_total"})," metric."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Click ",(0,n.jsx)(s.code,{children:"Run queries"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["You should now see a ",(0,n.jsx)(s.code,{children:"Time series"})," graph like this:"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"dashboards",src:a(9695).Z+"",width:"3390",height:"2384"})}),"\n",(0,n.jsxs)(s.ol,{start:"9",children:["\n",(0,n.jsx)(s.li,{children:"Save the dashboard in Grafana."}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"make-the-dashboard-persistent",children:"Make the dashboard persistent"}),"\n",(0,n.jsx)(s.p,{children:"Now you know how to create a dashboard in Grafana for your custom metrics. You could now save the dashboard, but if Grafana would get re-started, the dashboard will be gone. To make the dashboard persistent we need to add it to a configmap."}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Go to ",(0,n.jsx)(s.code,{children:"apps"})," and open ",(0,n.jsx)(s.code,{children:"Gitea"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the list of repositories there is a repository called ",(0,n.jsx)(s.code,{children:"otomi/team-<team-name>-argocd"}),". Go to this repository."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Click ",(0,n.jsx)(s.code,{children:"Add File"})," and then ",(0,n.jsx)(s.code,{children:"New File"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Name the file ",(0,n.jsx)(s.code,{children:"my-custom-dashboard.yaml"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Add the following manifest to the file:"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-yaml",children:'apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: my-custom-dashboard\n  labels:\n    grafana_dashboard: "1"\n    release: grafana-dashboards-labs # change labs to the name of your team\ndata:\n  my-dashboard.json: |-\n    # paste your dashboard json here\n'})}),"\n",(0,n.jsxs)(s.ol,{start:"6",children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Before commiting changes, go back to Grafana."}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Click on ",(0,n.jsx)(s.code,{children:"Dashboard settings"})," (in the top right)."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the left menu click ",(0,n.jsx)(s.code,{children:"JSON model"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Copy the JSON model and paste it into the ConfigMap. Make sure to indent with 4."}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Delete the dashboard created in Grafana."}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsx)(s.p,{children:"Commit changes in Gitea."}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"The dashboard will now automatically be loaded into the Team's Grafana instance."})]})}function h(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},9695:(e,s,a)=>{a.d(s,{Z:()=>n});const n=a.p+"assets/images/dashboards-1-1fea3cea5c85e3ebdd5b5fd545054f02.png"},1151:(e,s,a)=>{a.d(s,{Z:()=>o,a:()=>d});var n=a(7294);const t={},r=n.createContext(t);function d(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);